import{fa_comment,fa_paper_plane,fa_street_view,fa_shirt,fa_camera_retro,fa_info_circle,fa_xmark}from"./icons.js";import{showMessage,i18n}from"./message.js";class ToolsManager{constructor(e,o,t){this.config=o,this.tools={hitokoto:{icon:fa_comment,callback:async()=>{const e=await fetch("https://v1.hitokoto.cn"),o=await e.json(),s=t.message.hitokoto,a=i18n(s,o.from,o.creator);showMessage(o.hitokoto,6e3,9),setTimeout(()=>{showMessage(a,4e3,9)},6e3)}},asteroids:{icon:fa_paper_plane,callback:()=>{if(window.Asteroids)window.ASTEROIDSPLAYERS||(window.ASTEROIDSPLAYERS=[]),window.ASTEROIDSPLAYERS.push(new window.Asteroids);else{const e=document.createElement("script");e.src="https://fastly.jsdelivr.net/gh/stevenjoezhang/asteroids/asteroids.js",document.head.appendChild(e)}}},"switch-model":{icon:fa_street_view,callback:()=>e.loadNextModel()},"switch-texture":{icon:fa_shirt,callback:()=>{let o="",s="";t&&(o=t.message.changeSuccess,s=t.message.changeFail),e.loadRandTexture(o,s)}},photo:{icon:fa_camera_retro,callback:()=>{const e=t.message.photo;showMessage(e,6e3,9);const o=document.getElementById("live2d");if(!o)return;const s=o.toDataURL(),a=document.createElement("a");a.style.display="none",a.href=s,a.download="live2d-photo.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},info:{icon:fa_info_circle,callback:()=>{open("https://github.com/stevenjoezhang/live2d-widget")}},quit:{icon:fa_xmark,callback:()=>{localStorage.setItem("waifu-display",Date.now().toString());const e=t.message.goodbye;showMessage(e,2e3,11);const o=document.getElementById("waifu");o&&(o.classList.remove("waifu-active"),setTimeout(()=>{o.classList.add("waifu-hidden");const e=document.getElementById("waifu-toggle");null==e||e.classList.add("waifu-toggle-active")},3e3))}}}}registerTools(){var e;Array.isArray(this.config.tools)||(this.config.tools=Object.keys(this.tools));for(const o of this.config.tools)if(this.tools[o]){const{icon:t,callback:s}=this.tools[o],a=document.createElement("span");a.id=`waifu-tool-${o}`,a.innerHTML=t,null===(e=document.getElementById("waifu-tool"))||void 0===e||e.insertAdjacentElement("beforeend",a),a.addEventListener("click",s)}}}export{ToolsManager};